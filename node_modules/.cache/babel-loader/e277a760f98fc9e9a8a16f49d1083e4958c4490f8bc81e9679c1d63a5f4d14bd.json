{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useToast } from '../contexts/ToastContext';\nimport { uploadFile, listFiles, deleteFile, getFileUrl } from '../services/fileService';\nexport const useFiles = () => {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const {\n    showToast\n  } = useToast();\n  const [files, setFiles] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [uploading, setUploading] = useState(false);\n  useEffect(() => {\n    if (user) {\n      fetchFiles();\n    }\n  }, [user]);\n  const fetchFiles = async () => {\n    if (!user) return;\n    try {\n      setLoading(true);\n      const fileList = await listFiles(user.id);\n      setFiles(fileList);\n    } catch (error) {\n      console.error('Erro ao buscar arquivos:', error);\n      showToast('Erro ao carregar arquivos', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleUpload = async file => {\n    if (!user) return;\n    try {\n      setUploading(true);\n      const newFile = await uploadFile(file, user.id);\n      setFiles(prev => [newFile, ...prev]);\n      showToast('Arquivo enviado com sucesso!');\n      return newFile;\n    } catch (error) {\n      console.error('Erro ao fazer upload:', error);\n      showToast('Erro ao enviar arquivo', 'error');\n      throw error;\n    } finally {\n      setUploading(false);\n    }\n  };\n  const handleDelete = async (fileId, filePath) => {\n    try {\n      await deleteFile(fileId, filePath);\n      setFiles(prev => prev.filter(file => file.id !== fileId));\n      showToast('Arquivo excluído com sucesso!');\n      return true;\n    } catch (error) {\n      console.error('Erro ao excluir arquivo:', error);\n      showToast('Erro ao excluir arquivo', 'error');\n      throw error;\n    }\n  };\n  const getDownloadUrl = async filePath => {\n    try {\n      return await getFileUrl(filePath);\n    } catch (error) {\n      console.error('Erro ao obter URL de download:', error);\n      showToast('Erro ao gerar link de download', 'error');\n      throw error;\n    }\n  };\n  return {\n    files,\n    loading,\n    uploading,\n    fetchFiles,\n    handleUpload,\n    handleDelete,\n    getDownloadUrl\n  };\n};\n_s(useFiles, \"YMTPPTMB16tqsDPXu2KI231mDPY=\", false, function () {\n  return [useAuth, useToast];\n});","map":{"version":3,"names":["useState","useEffect","useAuth","useToast","uploadFile","listFiles","deleteFile","getFileUrl","useFiles","_s","user","showToast","files","setFiles","loading","setLoading","uploading","setUploading","fetchFiles","fileList","id","error","console","handleUpload","file","newFile","prev","handleDelete","fileId","filePath","filter","getDownloadUrl"],"sources":["/root/m-software/drive-react/src/hooks/useFiles.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useToast } from '../contexts/ToastContext';\nimport { uploadFile, listFiles, deleteFile, getFileUrl } from '../services/fileService';\nimport { FileObject } from '../types/supabase';\n\nexport const useFiles = () => {\n  const { user } = useAuth();\n  const { showToast } = useToast();\n  \n  const [files, setFiles] = useState<FileObject[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [uploading, setUploading] = useState(false);\n  \n  useEffect(() => {\n    if (user) {\n      fetchFiles();\n    }\n  }, [user]);\n  \n  const fetchFiles = async () => {\n    if (!user) return;\n    \n    try {\n      setLoading(true);\n      const fileList = await listFiles(user.id);\n      setFiles(fileList);\n    } catch (error) {\n      console.error('Erro ao buscar arquivos:', error);\n      showToast('Erro ao carregar arquivos', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n  \n  const handleUpload = async (file: File) => {\n    if (!user) return;\n    \n    try {\n      setUploading(true);\n      const newFile = await uploadFile(file, user.id);\n      setFiles(prev => [newFile, ...prev]);\n      showToast('Arquivo enviado com sucesso!');\n      return newFile;\n    } catch (error) {\n      console.error('Erro ao fazer upload:', error);\n      showToast('Erro ao enviar arquivo', 'error');\n      throw error;\n    } finally {\n      setUploading(false);\n    }\n  };\n  \n  const handleDelete = async (fileId: string, filePath: string) => {\n    try {\n      await deleteFile(fileId, filePath);\n      setFiles(prev => prev.filter(file => file.id !== fileId));\n      showToast('Arquivo excluído com sucesso!');\n      return true;\n    } catch (error) {\n      console.error('Erro ao excluir arquivo:', error);\n      showToast('Erro ao excluir arquivo', 'error');\n      throw error;\n    }\n  };\n  \n  const getDownloadUrl = async (filePath: string) => {\n    try {\n      return await getFileUrl(filePath);\n    } catch (error) {\n      console.error('Erro ao obter URL de download:', error);\n      showToast('Erro ao gerar link de download', 'error');\n      throw error;\n    }\n  };\n  \n  return {\n    files,\n    loading,\n    uploading,\n    fetchFiles,\n    handleUpload,\n    handleDelete,\n    getDownloadUrl\n  };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}